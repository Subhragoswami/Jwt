Exception in thread "main" java.time.DateTimeException: Invalid date 'FEBRUARY 30'

   Long time = calculateDateByFrequency(MONTHLY , "8:28 pm");
        System.out.println(time);
    }
    public static Long calculateDateByFrequency(Frequency frequency, String time) {
        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("h:mm a");
        LocalTime reqTime = LocalTime.parse(time.trim().toLowerCase(Locale.ROOT), formatter);

        LocalDateTime now = LocalDateTime.now();
        LocalDateTime nextDateTime;
        switch (frequency) {
            case Frequency.DAILY ->
                    nextDateTime = now.toLocalTime().isAfter(reqTime) ? LocalDateTime.of(now.toLocalDate().plusDays(1), reqTime) : LocalDateTime.of(now.toLocalDate(), reqTime);
            case Frequency.MONTHLY ->
                    nextDateTime = now.toLocalTime().isAfter(reqTime) ? LocalDateTime.of(now.toLocalDate().plusMonths(1).withDayOfMonth(30), reqTime) : LocalDateTime.of(now.toLocalDate().withDayOfMonth(30), reqTime);
            case YEARLY ->
                    nextDateTime = now.toLocalTime().isAfter(reqTime) ? LocalDateTime.of(now.toLocalDate().plusYears(1), reqTime) : LocalDateTime.of(now.toLocalDate().withDayOfYear(1), reqTime);
            default -> throw new IllegalArgumentException("Invalid Frequency :" + frequency);
    




import java.time.*;
import java.time.format.DateTimeFormatter;
import java.util.Locale;

public class Test {
    public static void main(String[] args) {
        Long time = calculateDateByFrequency(Frequency.MONTHLY, "8:28 PM");
        System.out.println(time);
    }

    public static Long calculateDateByFrequency(Frequency frequency, String time) {
        // Parse the input time string into a LocalTime object
        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("h:mm a");
        LocalTime reqTime = LocalTime.parse(time.trim().toLowerCase(Locale.ROOT), formatter);

        LocalDateTime now = LocalDateTime.now();
        LocalDateTime nextDateTime;
        
        switch (frequency) {
            case DAILY:
                nextDateTime = now.toLocalTime().isAfter(reqTime) 
                    ? LocalDateTime.of(now.toLocalDate().plusDays(1), reqTime)
                    : LocalDateTime.of(now.toLocalDate(), reqTime);
                break;

            case MONTHLY:
                // Ensure the day is valid for the next month
                int dayOfMonth = now.getDayOfMonth(); // Get current day of the month
                int lastDayOfMonth = now.plusMonths(1).toLocalDate().lengthOfMonth();
                dayOfMonth = Math.min(dayOfMonth, lastDayOfMonth); // Adjust if the day exceeds the last day of next month

                nextDateTime = now.toLocalTime().isAfter(reqTime)
                    ? LocalDateTime.of(now.plusMonths(1).withDayOfMonth(dayOfMonth), reqTime)
                    : LocalDateTime.of(now.withDayOfMonth(dayOfMonth), reqTime);
                break;

            case YEARLY:
                nextDateTime = now.toLocalTime().isAfter(reqTime)
                    ? LocalDateTime.of(now.plusYears(1), reqTime)
                    : LocalDateTime.of(now.withDayOfYear(1), reqTime);
                break;

            default:
                throw new IllegalArgumentException("Invalid Frequency: " + frequency);
        }

        // Print the calculated date in milliseconds
        return nextDateTime.atZone(ZoneId.systemDefault()).toInstant().toEpochMilli();
    }
}

enum Frequency {
    DAILY,
    MONTHLY,
    YEARLY
}
