--liquibase formatted sql
--changeset Subhra:1
CREATE OR REPLACE  VIEW VIEW_REFUND_REPORT (TRANSACTION_DATE, MID, REFUND_TYPE, SBI_ORDER_REF_NUMBER, MERCHANT_ORDER_NUMBER, ATRN_NUM, BANK_NAME, PAYMODE_CODE, TRANSACTION_STATUS, ORDER_AMOUNT, REFUND_AMOUNT, COMMENTS, REFUND_STATUS, REMARKS, ARRN_NUM) AS
  SELECT TO_DATE('1970-01-01','YYYY-MM-DD')+(T.CREATED_DATE_NUM/1000/86400) AS TRANSACTION_DATE,
  T.MERCHANT_ID as MID,
  R.REFUND_TYPE,
  T.SBI_ORDER_REF_NUMBER,
  T.ORDER_REF_NUMBER AS MERCHANT_ORDER_NUMBER,
  T.ATRN_NUM,
  T.CHANNEL_BANK AS BANK_NAME,
  T.PAY_MODE     AS PAYMODE_CODE,
  T.TRANSACTION_STATUS,
  T.ORDER_AMOUNT,
  R.REFUND_AMOUNT,
  R.COMMENTS,
  R.REFUND_STATUS,
  '' AS REMARKS,
  R.ARRN_NUM
FROM MERCHANT_ORDER_PAYMENTS_TXN T ,
  REFUND_BOOKING_TXN R
WHERE T.MERCHANT_ID       =R.MERCHANT_ID
AND T.ATRN_NUM=R.ATRN_NUM
AND T.SBI_ORDER_REF_NUMBER=R.SBI_ORDER_REF_NUMBER;


Caused by: liquibase.exception.DatabaseException: ORA-00904: "R"."COMMENTS": invalid identifier
