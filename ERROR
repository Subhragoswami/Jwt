package com.epay.reporting.util.queries;

public class TransactionPaymodeQueries {

    public static String JDBC_TRANSACTION_PAYMODE = "SELECT TO_CHAR(TO_DATE(TRANSACTION_DATE, 'DD-MM-YY'), 'Mon-YYYY') as transactionDate, " +
            "paymode_code as payMode, sum(total_success_amount) as totalSuccessAmount, " +
            "sum(total_debit_amount)as totalDebitAmount, " +
            "round(sum(total_success_amount)/sum(total_debit_amount) *100, 2) as " +
            "successPercentage FROM view_transaction_paymode_daily_report WHERE MID = :mId AND " +
            "PAYMODE_CODE is NOT NULL AND TRANSACTION_DATE BETWEEN TO_DATE('1-01-2025', 'DD-MM-YYYY') AND " +
            "TO_DATE('31-01-2025', 'DD-MM-YYYY') GROUP BY TO_CHAR(TO_DATE(TRANSACTION_DATE, 'DD-MM-YY'), 'Mon-YYYY'),paymode_code";
}

this query is working fine if i  do this it's notwoking
package com.epay.reporting.util.queries;

public class TransactionPaymodeQueries {

    public static String JDBC_TRANSACTION_PAYMODE = "SELECT TO_CHAR(TO_DATE(TRANSACTION_DATE, 'DD-MM-YY'), 'Mon-YYYY') as transactionDate, " +
            "paymode_code as payMode, sum(total_success_amount) as totalSuccessAmount, " +
            "sum(total_debit_amount)as totalDebitAmount, " +
            "round(sum(total_success_amount)/sum(total_debit_amount) *100, 2) as " +
            "successPercentage FROM view_transaction_paymode_daily_report WHERE MID = :mId AND " +
            "PAYMODE_CODE is NOT NULL AND TRANSACTION_DATE BETWEEN TO_DATE(:startDate, 'DD-MM-YYYY') AND " +
            "TO_DATE(:endDate, 'DD-MM-YYYY') GROUP BY TO_CHAR(TO_DATE(TRANSACTION_DATE, 'DD-MM-YY'), 'Mon-YYYY'),paymode_code";
}



    public List<TransactionPaymodeReport> getPayModeReport(String mid, TransactionPayModeRequest transactionPayModeRequest) {
        MapSqlParameterSource parameters = new MapSqlParameterSource();
        parameters.addValue("mId", mid);
        parameters.addValue("startDate", transactionPayModeRequest.getFromDate());
        parameters.addValue("endDate", transactionPayModeRequest.getToDate());

        return namedParameterJdbcTemplate.query(
                TransactionPaymodeQueries.JDBC_TRANSACTION_PAYMODE,
                parameters,
                (rs, rowNum) -> mapTransactionPaymodeReport(rs)
        );
    }

    private TransactionPaymodeReport mapTransactionPaymodeReport(ResultSet rs) throws SQLException {
        return TransactionPaymodeReport.builder()
                .transactionDate(rs.getString("transactionDate"))
                .PaymodeCode(rs.getString("payMode"))
                .totalSuccessAmount(rs.getBigDecimal("totalSuccessAmount"))
                .totalDebitAmount(rs.getBigDecimal("totalDebitAmount"))
                .successPercentage(rs.getBigDecimal("successPercentage"))
                .build();
    }
{
    "fromDate": "09-01-25",
    "toDate": "09-01-25"
}
